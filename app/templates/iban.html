
{% extends 'layout.html' %}

{% block content %}

<header>
    <nav>
        <ul style="display: flex; justify-content: space-between; list-style: none; padding: 0;">
            <li>
                <button id="edit-selected" onclick="openDetailsPopup('massedit-popup')" disabled title="Edit (nichts ausgew√§hlt)">
                    ‚úèÔ∏è
                </button>
                <button onclick="openDetailsPopup('tagging-popup')">
                    Tagging
                </button>
                <button onclick="openDetailsPopup('cat-popup')">
                    Kategorisieren
                </button>
            </li>
            <li>
                <input type="text" id="daterange-picker" placeholder="Select date range">
                <input type="text" id="filter-text" placeholder="Filter transactions">
                <button id="apply-filter">Apply</button>
            </li>
            <li>
                <button id="settings-button" title="Settings">‚öôÔ∏è</button>
                <a href="/logout" title="Logout">üö™</a>
            </li>
        </ul>
    </nav>
</header>

<main>
    <table class="transactions">
        <thead>
            <tr>
                <th><input type="checkbox" id="select-all"></th>
                <th>Date</th>
                <th>Text</th>
                <th>Category</th>
                <th>Tags</th>
                <th>Betrag</th>
                <th>&nbsp;</th>
            </tr>
        </thead>
        <tbody>
            {% for transaction in transactions %}
            <tr id="tr-{{ transaction.uuid }}">
                <td><input type="checkbox" class="row-checkbox" name="{{ transaction.uuid }}"
                    data-tx="{{transaction.date_tx}} - ({{transaction.uuid}})"></td>
                <td class="td-date_tx">{{ transaction.date_tx }}</td>
                <td class="td-text_tx">{{ transaction.text_tx }}</td>
                <td>
                    {% if transaction.category %}
                    <span title="{{ transaction.category }}" style="cursor: help;">üîñ</span>
                    {% else %}
                    &nbsp;
                    {% endif %}
                </td>
                <td>
                    {% for tag in transaction.tags %}
                    <span class="tag-chip">
                        {{ tag }}
                    </span>
                    {% endfor %}
                </td>
                <td class="td-betrag">{{ transaction.currency }} {{ transaction.betrag }}</td>
                <td>
                    <button class="details-button" title="Show details" onclick="openDetailsPopup('details-popup', '{{ transaction.uuid }}')" style="cursor: pointer;">‚ÑπÔ∏è</button>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</main>

<!-- Popups -->
<div id="massedit-popup" style="display: none;" class="popup">
    <h2>Mass Edit</h2>
    <p>Aktion auf die ausgew√§hlten Transaktionen anwenden:</p>
    <ul id="tx-select-list">
    </ul>
    <button onclick="removeTags()">Tags entfernen</button>
    <button onclick="removeCats()">Kategorie entfernen</button>
    <button onclick="closePopup('massedit-popup')">Close</button>
</div>

<div id="tagging-popup" style="display: none;" class="popup">
    <h2>Tag</h2>
    <p>Es k√∂nnen standardm√§√üig alle oder nur eine ausgew√§hlte Regel auf alle Transaktionen zum Tagging genutzt werden.</p>
    <p>
        <select id="tag-select">
            <option value="">Alle Regeln</option>
        </select>
    </p>
    <button onclick="tagEntries()">Tag</button>
    <button onclick="closePopup('tagging-popup')">Close</button>
</div>

<div id="cat-popup" style="display: none;" class="popup">
    <h2>Kategorie</h2>
    <p>Es k√∂nnen standardm√§√üig alle oder nur eine ausgew√§hlte Regel auf alle Transaktionen zum Kategorisieren genutzt werden.</p>
    <p>
        <select id="cat-select">
            <option value="">Alle Regeln</option>
        </select>
    </p>
    <button onclick="catEntries()">Kategorisieren</button>
    <button onclick="closePopup('cat-popup')">Close</button>
</div>

<div id="settings-popup" style="display: none;" class="popup">
    <h2>Settings</h2>
    <p>Dummy content for settings.</p>
    <button onclick="closePopup('settings-popup')">Close</button>
</div>

<div id="details-popup" style="display: none;" class="popup">
    <h2>Transaction Details</h2>
    <code id="result-text">
        ...
    </code>
    <button onclick="closePopup('details-popup')">Close</button>
</div>

<script src="{{ url_for('static', filename='js/iban.js') }}"></script>

{% endblock %}
